{"ast":null,"code":"import _slicedToArray from\"/Users/a582616/Desktop/Web Development/Project/Instagram/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Button}from'@material-ui/core';import firebase from'firebase';import{storage,db}from'./firebase';import'./ImageUpload.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ImageUpload(_ref){var username=_ref.username;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),caption=_useState6[0],setCaption=_useState6[1];var handleChange=function handleChange(e){if(e.target.files[0]){setImage(e.target.files[0]);}};var handleUpload=function handleUpload(e){var uploadTask=storage.ref(\"images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){// progress function ...\nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(progress);},function(error){// Error function ...\nconsole.log(error);alert(error.message);},function(){// complete function ...\nstorage.ref(\"images\").child(image.name).getDownloadURL().then(function(url){// post image inside db\ndb.collection(\"posts\").add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),caption:caption,imageUrl:url,username:username});/* reset */setProgress(0);setCaption(\"\");setImage(null);});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"imageupload\",children:[/*#__PURE__*/_jsx(\"progress\",{className:\"imageupload__progress\",value:progress,max:\"100\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Enter a caption...\",onChange:function onChange(event){return setCaption(event.target.value);},value:caption}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/_jsx(Button,{onClick:handleUpload,children:\"Upload\"})]});}export default ImageUpload;","map":{"version":3,"sources":["/Users/a582616/Desktop/Web Development/Project/Instagram/instagram-clone/src/ImageUpload.js"],"names":["React","useState","Button","firebase","storage","db","ImageUpload","username","image","setImage","progress","setProgress","caption","setCaption","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"mappings":"+LAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,MAAT,KAAuB,mBAAvB,CACA,MAAOC,CAAAA,QAAP,KAAqB,UAArB,CACA,OAASC,OAAT,CAAkBC,EAAlB,KAA4B,YAA5B,CACA,MAAO,mBAAP,C,wFAEA,QAASC,CAAAA,WAAT,MAAiC,IAAXC,CAAAA,QAAW,MAAXA,QAAW,eACLN,QAAQ,CAAC,IAAD,CADH,wCACxBO,KADwB,eACjBC,QADiB,8BAECR,QAAQ,CAAC,CAAD,CAFT,yCAExBS,QAFwB,eAEdC,WAFc,8BAGDV,QAAQ,CAAC,EAAD,CAHP,yCAGxBW,OAHwB,eAGfC,UAHe,eAK/B,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CAC1B,GAAIA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAJ,CAAuB,CACrBR,QAAQ,CAACM,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACD,CACF,CAJD,CAMA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACH,CAAD,CAAO,CAC1B,GAAMI,CAAAA,UAAU,CAAGf,OAAO,CAACgB,GAAR,kBAAsBZ,KAAK,CAACa,IAA5B,GAAoCC,GAApC,CAAwCd,KAAxC,CAAnB,CACAW,UAAU,CAACI,EAAX,CACE,eADF,CAEE,SAACC,QAAD,CAAc,CACZ;AACA,GAAMd,CAAAA,QAAQ,CAAGe,IAAI,CAACC,KAAL,CACdF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GADrC,CAAjB,CAGAjB,WAAW,CAACD,QAAD,CAAX,CACD,CARH,CASE,SAACmB,KAAD,CAAW,CACT;AACAC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACAG,KAAK,CAACH,KAAK,CAACI,OAAP,CAAL,CACD,CAbH,CAcE,UAAM,CACJ;AACA7B,OAAO,CACJgB,GADH,CACO,QADP,EAEGc,KAFH,CAES1B,KAAK,CAACa,IAFf,EAGGc,cAHH,GAIGC,IAJH,CAIQ,SAAAC,GAAG,CAAI,CACX;AACAhC,EAAE,CAACiC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACzBC,SAAS,CAAErC,QAAQ,CAACsC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADc,CAEzB/B,OAAO,CAAEA,OAFgB,CAGzBgC,QAAQ,CAAEP,GAHe,CAIzB9B,QAAQ,CAAEA,QAJe,CAA3B,EAOA,WACAI,WAAW,CAAC,CAAD,CAAX,CACAE,UAAU,CAAC,EAAD,CAAV,CACAJ,QAAQ,CAAC,IAAD,CAAR,CACD,CAjBH,EAkBD,CAlCH,EAoCD,CAtCD,CAuCA,mBACE,aAAK,SAAS,CAAC,aAAf,wBACE,iBAAU,SAAS,CAAC,uBAApB,CAA4C,KAAK,CAAEC,QAAnD,CAA6D,GAAG,CAAC,KAAjE,EADF,cAEE,cAAO,IAAI,CAAC,MAAZ,CACE,WAAW,CAAC,oBADd,CAEE,QAAQ,CAAE,kBAAAmC,KAAK,QAAIhC,CAAAA,UAAU,CAACgC,KAAK,CAAC7B,MAAN,CAAa8B,KAAd,CAAd,EAFjB,CAGE,KAAK,CAAElC,OAHT,EAFF,cAME,cAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEE,YAA7B,EANF,cAOE,KAAC,MAAD,EAAQ,OAAO,CAAEI,YAAjB,oBAPF,GADF,CAcD,CAED,cAAeZ,CAAAA,WAAf","sourcesContent":["import React, { useState } from 'react';\nimport { Button } from '@material-ui/core';\nimport firebase from 'firebase';\nimport { storage, db } from './firebase';\nimport './ImageUpload.css';\n\nfunction ImageUpload({username}) {\n  const [image, setImage] = useState(null);\n  const [progress, setProgress] = useState(0);\n  const [caption, setCaption] = useState('');\n\n  const handleChange = (e) => {\n    if (e.target.files[0]) {\n      setImage(e.target.files[0]);\n    }\n  };\n\n  const handleUpload = (e) => {\n    const uploadTask = storage.ref(`images/${image.name}`).put(image);\n    uploadTask.on(\n      \"state_changed\",\n      (snapshot) => {\n        // progress function ...\n        const progress = Math.round(\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n        );\n        setProgress(progress);\n      },\n      (error) => {\n        // Error function ...\n        console.log(error);\n        alert(error.message);\n      },\n      () => {\n        // complete function ...\n        storage\n          .ref(\"images\")\n          .child(image.name)\n          .getDownloadURL()\n          .then(url => {\n            // post image inside db\n            db.collection(\"posts\").add({\n              timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n              caption: caption,\n              imageUrl: url,\n              username: username\n            });\n\n            /* reset */\n            setProgress(0);\n            setCaption(\"\");\n            setImage(null);\n          })\n      }\n    )\n  };\n  return (\n    <div className=\"imageupload\">\n      <progress className=\"imageupload__progress\" value={progress} max=\"100\" />\n      <input type=\"text\"\n        placeholder=\"Enter a caption...\"\n        onChange={event => setCaption(event.target.value)}\n        value={caption}/>\n      <input type=\"file\" onChange={handleChange} />\n      <Button onClick={handleUpload}>\n        Upload\n      </Button>\n\n    </div>\n  )\n}\n\nexport default ImageUpload\n"]},"metadata":{},"sourceType":"module"}